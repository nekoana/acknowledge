> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [juejin.cn](https://juejin.cn/post/7159079522749382687)

æŒç»­åˆ›ä½œï¼ŒåŠ é€Ÿæˆé•¿ï¼è¿™æ˜¯æˆ‘å‚ä¸ã€Œæ˜é‡‘æ—¥æ–°è®¡åˆ’ Â· 10 æœˆæ›´æ–‡æŒ‘æˆ˜ã€çš„ç¬¬ 28 å¤©ï¼Œ[ç‚¹å‡»æŸ¥çœ‹æ´»åŠ¨è¯¦æƒ…](https://juejin.cn/post/7147654075599978532 "https://juejin.cn/post/7147654075599978532")

å‰è¨€
==

æœ¬åšæ–‡å°†ä»å†…å­˜ç®¡ç†çš„è§’åº¦ï¼Œè¿›ä¸€æ­¥æ¢ç´¢ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰ã€‚åƒåœ¾æ”¶é›†æœºåˆ¶ä¸ºæˆ‘ä»¬æ‰“ç†äº†å¾ˆå¤šç¹ççš„å·¥ä½œï¼Œå¤§å¤§æé«˜äº†å¼€å‘çš„æ•ˆç‡ï¼Œä½†æ˜¯ï¼Œåƒåœ¾æ”¶é›†ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæ‡‚å¾— JVM å†…éƒ¨çš„å†…å­˜ç»“æ„ã€å·¥ä½œæœºåˆ¶ï¼Œæ˜¯è®¾è®¡é«˜æ‰©å±•æ€§åº”ç”¨å’Œè¯Šæ–­è¿è¡Œæ—¶é—®é¢˜çš„åŸºç¡€ï¼Œä¹Ÿæ˜¯ Java å·¥ç¨‹å¸ˆè¿›é˜¶çš„å¿…å¤‡èƒ½åŠ›ã€‚

æœ¬ç¯‡åšæ–‡çš„é‡ç‚¹æ˜¯ï¼Œ**è°ˆè°ˆ JVM å†…å­˜åŒºåŸŸçš„åˆ’åˆ†ï¼Œå“ªäº›åŒºåŸŸå¯èƒ½å‘ç”Ÿ OutOfMemoryErrorï¼Ÿ**

æ¦‚è¿°
==

é€šå¸¸å¯ä»¥æŠŠ JVM å†…å­˜åŒºåŸŸåˆ†ä¸ºä¸‹é¢å‡ ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ï¼Œæœ‰çš„åŒºåŸŸæ˜¯ä»¥çº¿ç¨‹ä¸ºå•ä½ï¼Œè€Œæœ‰çš„åŒºåŸŸåˆ™æ˜¯æ•´ä¸ª JVM è¿›ç¨‹å”¯ä¸€çš„ã€‚

é¦–å…ˆï¼Œ**ç¨‹åºè®¡æ•°å™¨**ï¼ˆPCï¼ŒProgram Counter Registerï¼‰ã€‚åœ¨ JVM è§„èŒƒä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå¹¶ä¸”ä»»ä½•æ—¶é—´ä¸€ä¸ªçº¿ç¨‹éƒ½åªæœ‰ä¸€ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„å½“å‰æ–¹æ³•ã€‚ç¨‹åºè®¡æ•°å™¨ä¼šå­˜å‚¨å½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„ Java æ–¹æ³•çš„ JVM æŒ‡ä»¤åœ°å€ï¼›æˆ–è€…ï¼Œå¦‚æœæ˜¯åœ¨æ‰§è¡Œæœ¬åœ°æ–¹æ³•ï¼Œåˆ™æ˜¯æœªæŒ‡å®šå€¼ï¼ˆundefinedï¼‰ã€‚

ç¬¬äºŒï¼Œ**Java è™šæ‹Ÿæœºæ ˆ**ï¼ˆJava Virtual Machine Stackï¼‰ï¼Œæ—©æœŸä¹Ÿå« Java æ ˆã€‚æ¯ä¸ªçº¿ç¨‹åœ¨åˆ›å»ºæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ ˆï¼Œå…¶å†…éƒ¨ä¿å­˜ä¸€ä¸ªä¸ªçš„æ ˆå¸§ï¼ˆStack Frameï¼‰ï¼Œå¯¹åº”ç€ä¸€æ¬¡æ¬¡çš„ Java æ–¹æ³•è°ƒç”¨ã€‚

å‰é¢è°ˆç¨‹åºè®¡æ•°å™¨æ—¶ï¼Œæåˆ°äº†å½“å‰æ–¹æ³•ï¼›åŒç†ï¼Œåœ¨ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œå¯¹åº”çš„åªä¼šæœ‰ä¸€ä¸ªæ´»åŠ¨çš„æ ˆå¸§ï¼Œé€šå¸¸å«ä½œå½“å‰å¸§ï¼Œæ–¹æ³•æ‰€åœ¨çš„ç±»å«ä½œå½“å‰ç±»ã€‚å¦‚æœåœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œå¯¹åº”çš„æ–°çš„æ ˆå¸§ä¼šè¢«åˆ›å»ºå‡ºæ¥ï¼Œæˆä¸ºæ–°çš„å½“å‰å¸§ï¼Œä¸€ç›´åˆ°å®ƒè¿”å›ç»“æœæˆ–è€…æ‰§è¡Œç»“æŸã€‚JVM ç›´æ¥å¯¹ Java æ ˆçš„æ“ä½œåªæœ‰ä¸¤ä¸ªï¼Œå°±æ˜¯å¯¹æ ˆå¸§çš„å‹æ ˆå’Œå‡ºæ ˆã€‚

æ ˆå¸§ä¸­å­˜å‚¨ç€å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°ï¼ˆoperandï¼‰æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•æ­£å¸¸é€€å‡ºæˆ–è€…å¼‚å¸¸é€€å‡ºçš„å®šä¹‰ç­‰ã€‚

ç¬¬ä¸‰ï¼Œ**å †**ï¼ˆHeapï¼‰ï¼Œå®ƒæ˜¯ Java å†…å­˜ç®¡ç†çš„æ ¸å¿ƒåŒºåŸŸï¼Œç”¨æ¥æ”¾ç½® Java å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰åˆ›å»ºçš„ Java å¯¹è±¡å®ä¾‹éƒ½æ˜¯è¢«ç›´æ¥åˆ†é…åœ¨å †ä¸Šã€‚å †è¢«æ‰€æœ‰çš„çº¿ç¨‹å…±äº«ï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬æŒ‡å®šçš„ â€œXmxâ€ ä¹‹ç±»å‚æ•°å°±æ˜¯ç”¨æ¥æŒ‡å®šæœ€å¤§å †ç©ºé—´ç­‰æŒ‡æ ‡ã€‚

ç†æ‰€å½“ç„¶ï¼Œå †ä¹Ÿæ˜¯åƒåœ¾æ”¶é›†å™¨é‡ç‚¹ç…§é¡¾çš„åŒºåŸŸï¼Œæ‰€ä»¥å †å†…ç©ºé—´è¿˜ä¼šè¢«ä¸åŒçš„åƒåœ¾æ”¶é›†å™¨è¿›è¡Œè¿›ä¸€æ­¥çš„ç»†åˆ†ï¼Œæœ€æœ‰åçš„å°±æ˜¯æ–°ç”Ÿä»£ã€è€å¹´ä»£çš„åˆ’åˆ†ã€‚

ç¬¬å››ï¼Œ**æ–¹æ³•åŒº**ï¼ˆMethod Areaï¼‰ã€‚è¿™ä¹Ÿæ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨æ‰€è°“çš„å…ƒï¼ˆMetaï¼‰æ•°æ®ï¼Œä¾‹å¦‚ç±»ç»“æ„ä¿¡æ¯ï¼Œä»¥åŠå¯¹åº”çš„è¿è¡Œæ—¶å¸¸é‡æ± ã€å­—æ®µã€æ–¹æ³•ä»£ç ç­‰ã€‚

ç”±äºæ—©æœŸçš„ Hotspot JVM å®ç°ï¼Œå¾ˆå¤šäººä¹ æƒ¯äºå°†æ–¹æ³•åŒºç§°ä¸ºæ°¸ä¹…ä»£ï¼ˆPermanent Generationï¼‰ã€‚Oracle JDK 8 ä¸­å°†æ°¸ä¹…ä»£ç§»é™¤ï¼ŒåŒæ—¶å¢åŠ äº†å…ƒæ•°æ®åŒºï¼ˆMetaspaceï¼‰ã€‚

ç¬¬äº”ï¼Œ**è¿è¡Œæ—¶å¸¸é‡æ± **ï¼ˆRun-Time Constant Poolï¼‰ï¼Œè¿™æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœä»”ç»†åˆ†æè¿‡åç¼–è¯‘çš„ç±»æ–‡ä»¶ç»“æ„ï¼Œä½ èƒ½çœ‹åˆ°ç‰ˆæœ¬å·ã€å­—æ®µã€æ–¹æ³•ã€è¶…ç±»ã€æ¥å£ç­‰å„ç§ä¿¡æ¯ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯å°±æ˜¯å¸¸é‡æ± ã€‚Java çš„å¸¸é‡æ± å¯ä»¥å­˜æ”¾å„ç§å¸¸é‡ä¿¡æ¯ï¼Œä¸ç®¡æ˜¯ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡ï¼Œè¿˜æ˜¯éœ€è¦åœ¨è¿è¡Œæ—¶å†³å®šçš„ç¬¦å·å¼•ç”¨ï¼Œæ‰€ä»¥å®ƒæ¯”ä¸€èˆ¬è¯­è¨€çš„ç¬¦å·è¡¨å­˜å‚¨çš„ä¿¡æ¯æ›´åŠ å®½æ³›ã€‚

ç¬¬å…­ï¼Œ**æœ¬åœ°æ–¹æ³•æ ˆ**ï¼ˆNative Method Stackï¼‰ã€‚å®ƒå’Œ Java è™šæ‹Ÿæœºæ ˆæ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œæ”¯æŒå¯¹æœ¬åœ°æ–¹æ³•çš„è°ƒç”¨ï¼Œä¹Ÿæ˜¯æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ›å»ºä¸€ä¸ªã€‚åœ¨ Oracle Hotspot JVM ä¸­ï¼Œæœ¬åœ°æ–¹æ³•æ ˆå’Œ Java è™šæ‹Ÿæœºæ ˆæ˜¯åœ¨åŒä¸€å—å„¿åŒºåŸŸï¼Œè¿™å®Œå…¨å–å†³äºæŠ€æœ¯å®ç°çš„å†³å®šï¼Œå¹¶æœªåœ¨è§„èŒƒä¸­å¼ºåˆ¶ã€‚

æ­£æ–‡
==

é¦–å…ˆï¼Œä¸ºäº†è®©ä½ æœ‰ä¸ªæ›´åŠ ç›´è§‚ã€æ¸…æ™°çš„å°è±¡ï¼Œæˆ‘ç”»äº†ä¸€ä¸ªç®€å•çš„å†…å­˜ç»“æ„å›¾ï¼Œé‡Œé¢å±•ç¤ºäº†æˆ‘å‰é¢æåˆ°çš„å †ã€çº¿ç¨‹æ ˆç­‰åŒºåŸŸï¼Œå¹¶ä»æ•°é‡ä¸Šè¯´æ˜äº†ä»€ä¹ˆæ˜¯çº¿ç¨‹ç§æœ‰ï¼Œä¾‹å¦‚ï¼Œç¨‹åºè®¡æ•°å™¨ã€Java æ ˆç­‰ï¼Œä»¥åŠä»€ä¹ˆæ˜¯ Java è¿›ç¨‹å”¯ä¸€ã€‚å¦å¤–ï¼Œè¿˜é¢å¤–åˆ’åˆ†å‡ºäº†ç›´æ¥å†…å­˜ç­‰åŒºåŸŸã€‚

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d7b4173c3fe941cf959831aeb3995cb8~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp?)

è¿™å¼ å›¾åæ˜ äº†å®é™…ä¸­ Java è¿›ç¨‹å†…å­˜å ç”¨ï¼Œä¸è§„èŒƒä¸­å®šä¹‰çš„ JVM è¿è¡Œæ—¶æ•°æ®åŒºä¹‹é—´çš„å·®åˆ«ï¼Œå®ƒå¯ä»¥çœ‹ä½œæ˜¯è¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€ä¸ªè¶…é›†ã€‚æ¯•ç«Ÿç†è®ºä¸Šçš„è§†è§’å’Œç°å®ä¸­çš„è§†è§’æ˜¯æœ‰åŒºåˆ«çš„ï¼Œè§„èŒƒä¾§é‡çš„æ˜¯é€šç”¨çš„ã€æ— å·®åˆ«çš„éƒ¨åˆ†ï¼Œè€Œå¯¹äºåº”ç”¨å¼€å‘è€…æ¥è¯´ï¼Œåªè¦æ˜¯ Java è¿›ç¨‹åœ¨è¿è¡Œæ—¶ä¼šå ç”¨ï¼Œéƒ½ä¼šå½±å“åˆ°æˆ‘ä»¬çš„å·¥ç¨‹å®è·µã€‚

è¿™é‡Œç®€è¦ä»‹ç»ä¸¤ç‚¹åŒºåˆ«ï¼š

*   ç›´æ¥å†…å­˜ï¼ˆDirect Memoryï¼‰åŒºåŸŸï¼Œå®ƒå°±æ˜¯åœ¨åšæ–‡ [ã€JAVAã€‘æ–‡ä»¶æ‹·è´æ–¹å¼](https://juejin.cn/post/7155292381321887758 "https://juejin.cn/post/7155292381321887758") ä¸­è°ˆåˆ°çš„ Direct Buffer æ‰€ç›´æ¥åˆ†é…çš„å†…å­˜ï¼Œä¹Ÿæ˜¯ä¸ªå®¹æ˜“å‡ºç°é—®é¢˜çš„åœ°æ–¹ã€‚å°½ç®¡ï¼Œåœ¨ JVM å·¥ç¨‹å¸ˆçš„çœ¼ä¸­ï¼Œå¹¶ä¸è®¤ä¸ºå®ƒæ˜¯ JVM å†…éƒ¨å†…å­˜çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå¹¶æœªä½“ç° JVM å†…å­˜æ¨¡å‹ä¸­ã€‚
*   JVM æœ¬èº«æ˜¯ä¸ªæœ¬åœ°ç¨‹åºï¼Œè¿˜éœ€è¦å…¶ä»–çš„å†…å­˜å»å®Œæˆå„ç§åŸºæœ¬ä»»åŠ¡ï¼Œæ¯”å¦‚ï¼ŒJIT Compiler åœ¨è¿è¡Œæ—¶å¯¹çƒ­ç‚¹æ–¹æ³•è¿›è¡Œç¼–è¯‘ï¼Œå°±ä¼šå°†ç¼–è¯‘åçš„æ–¹æ³•å‚¨å­˜åœ¨ Code Cache é‡Œé¢ï¼›GC ç­‰åŠŸèƒ½éœ€è¦è¿è¡Œåœ¨æœ¬åœ°çº¿ç¨‹ä¹‹ä¸­ï¼Œç±»ä¼¼éƒ¨åˆ†éƒ½éœ€è¦å ç”¨å†…å­˜ç©ºé—´ã€‚è¿™äº›æ˜¯å®ç° JVM JIT ç­‰åŠŸèƒ½çš„éœ€è¦ï¼Œä½†è§„èŒƒä¸­å¹¶ä¸æ¶‰åŠã€‚

å¦‚æœæ·±å…¥åˆ° JVM çš„å®ç°ç»†èŠ‚ï¼Œä½ ä¼šå‘ç°ä¸€äº›ç»“è®ºä¼¼ä¹æœ‰äº›æ¨¡æ£±ä¸¤å¯ï¼Œæ¯”å¦‚ï¼š

*   Java å¯¹è±¡æ˜¯ä¸æ˜¯éƒ½åˆ›å»ºåœ¨å †ä¸Šçš„å‘¢ï¼Ÿ

æˆ‘æ³¨æ„åˆ°æœ‰ä¸€äº›è§‚ç‚¹ï¼Œè®¤ä¸ºé€šè¿‡é€ƒé€¸åˆ†æï¼ŒJVM ä¼šåœ¨æ ˆä¸Šåˆ†é…é‚£äº›ä¸ä¼šé€ƒé€¸çš„å¯¹è±¡ï¼Œè¿™åœ¨ç†è®ºä¸Šæ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å–å†³äº JVM è®¾è®¡è€…çš„é€‰æ‹©ã€‚æ®æˆ‘æ‰€çŸ¥ï¼ŒOracle Hotspot JVM ä¸­å¹¶æœªè¿™ä¹ˆåšï¼Œè¿™ä¸€ç‚¹åœ¨é€ƒé€¸åˆ†æç›¸å…³çš„[æ–‡æ¡£](https://link.juejin.cn?target=https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F8%2Fdocs%2Ftechnotes%2Fguides%2Fvm%2Fperformance-enhancements-7.html%23escapeAnalysis "https://docs.oracle.com/javase/8/docs/technotes/guides/vm/performance-enhancements-7.html#escapeAnalysis")é‡Œå·²ç»è¯´æ˜ï¼Œæ‰€ä»¥å¯ä»¥æ˜ç¡®æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½æ˜¯åˆ›å»ºåœ¨å †ä¸Šã€‚

*   ç›®å‰å¾ˆå¤šä¹¦ç±è¿˜æ˜¯åŸºäº JDK 7 ä»¥å‰çš„ç‰ˆæœ¬ï¼ŒJDK å·²ç»å‘ç”Ÿäº†å¾ˆå¤§å˜åŒ–ï¼ŒIntern å­—ç¬¦ä¸²çš„ç¼“å­˜å’Œé™æ€å˜é‡æ›¾ç»éƒ½è¢«åˆ†é…åœ¨æ°¸ä¹…ä»£ä¸Šï¼Œè€Œæ°¸ä¹…ä»£å·²ç»è¢«å…ƒæ•°æ®åŒºå–ä»£ã€‚ä½†æ˜¯ï¼ŒIntern å­—ç¬¦ä¸²ç¼“å­˜å’Œé™æ€å˜é‡å¹¶ä¸æ˜¯è¢«è½¬ç§»åˆ°å…ƒæ•°æ®åŒºï¼Œè€Œæ˜¯ç›´æ¥åœ¨å †ä¸Šåˆ†é…ï¼Œæ‰€ä»¥è¿™ä¸€ç‚¹åŒæ ·ç¬¦åˆå‰é¢ä¸€ç‚¹çš„ç»“è®ºï¼šå¯¹è±¡å®ä¾‹éƒ½æ˜¯åˆ†é…åœ¨å †ä¸Šã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯ OOM é—®é¢˜ï¼Œå®ƒå¯èƒ½åœ¨å“ªäº›å†…å­˜åŒºåŸŸå‘ç”Ÿï¼Ÿ

é¦–å…ˆï¼ŒOOM å¦‚æœé€šä¿—ç‚¹å„¿è¯´ï¼Œå°±æ˜¯ JVM å†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œjavadoc ä¸­å¯¹ OutOfMemoryError çš„è§£é‡Šæ˜¯ï¼Œæ²¡æœ‰ç©ºé—²å†…å­˜ï¼Œå¹¶ä¸”åƒåœ¾æ”¶é›†å™¨ä¹Ÿæ— æ³•æä¾›æ›´å¤šå†…å­˜ã€‚

è¿™é‡Œé¢éšå«ç€ä¸€å±‚æ„æ€æ˜¯ï¼Œåœ¨æŠ›å‡º OutOfMemoryError ä¹‹å‰ï¼Œé€šå¸¸åƒåœ¾æ”¶é›†å™¨ä¼šè¢«è§¦å‘ï¼Œå°½å…¶æ‰€èƒ½å»æ¸…ç†å‡ºç©ºé—´ï¼Œä¾‹å¦‚ï¼š

*   åœ¨åšæ–‡ [ã€JAVAã€‘å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€å¹»è±¡å¼•ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ](https://juejin.cn/post/7157718453582266405 "https://juejin.cn/post/7157718453582266405") çš„å¼•ç”¨æœºåˆ¶åˆ†æä¸­ï¼Œå·²ç»æåˆ°äº† JVM ä¼šå»å°è¯•å›æ”¶è½¯å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡ç­‰ã€‚
*   åœ¨ java.nio.BIts.reserveMemory() æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬èƒ½æ¸…æ¥šçš„çœ‹åˆ°ï¼ŒSystem.gc() ä¼šè¢«è°ƒç”¨ï¼Œä»¥æ¸…ç†ç©ºé—´ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨å¤§é‡ä½¿ç”¨ NIO çš„ Direct Buffer ä¹‹ç±»æ—¶ï¼Œé€šå¸¸å»ºè®®ä¸è¦åŠ ä¸‹é¢çš„å‚æ•°ï¼Œæ¯•ç«Ÿæ˜¯ä¸ªæœ€åçš„å°è¯•ï¼Œæœ‰å¯èƒ½é¿å…ä¸€å®šçš„å†…å­˜ä¸è¶³é—®é¢˜ã€‚

```
-XX:+DisableExplicitGC
å¤åˆ¶ä»£ç 
```

å½“ç„¶ï¼Œä¹Ÿä¸æ˜¯åœ¨ä»»ä½•æƒ…å†µä¸‹åƒåœ¾æ”¶é›†å™¨éƒ½ä¼šè¢«è§¦å‘çš„ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬å»åˆ†é…ä¸€ä¸ªè¶…å¤§å¯¹è±¡ï¼Œç±»ä¼¼ä¸€ä¸ªè¶…å¤§æ•°ç»„è¶…è¿‡å †çš„æœ€å¤§å€¼ï¼ŒJVM å¯ä»¥åˆ¤æ–­å‡ºåƒåœ¾æ”¶é›†å¹¶ä¸èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥ç›´æ¥æŠ›å‡º OutOfMemoryErrorã€‚

ä»æˆ‘å‰é¢åˆ†æçš„æ•°æ®åŒºçš„è§’åº¦ï¼Œé™¤äº†ç¨‹åºè®¡æ•°å™¨ï¼Œå…¶ä»–åŒºåŸŸéƒ½æœ‰å¯èƒ½ä¼šå› ä¸ºå¯èƒ½çš„ç©ºé—´ä¸è¶³å‘ç”Ÿ OutOfMemoryErrorï¼Œç®€å•æ€»ç»“å¦‚ä¸‹ï¼š

*   å †å†…å­˜ä¸è¶³æ˜¯æœ€å¸¸è§çš„ OOM åŸå› ä¹‹ä¸€ï¼ŒæŠ›å‡ºçš„é”™è¯¯ä¿¡æ¯æ˜¯ â€œjava.lang.OutOfMemoryError:Java heap spaceâ€ï¼ŒåŸå› å¯èƒ½åƒå¥‡ç™¾æ€ªï¼Œä¾‹å¦‚ï¼Œå¯èƒ½å­˜åœ¨å†…å­˜æ³„æ¼é—®é¢˜ï¼›ä¹Ÿå¾ˆæœ‰å¯èƒ½å°±æ˜¯å †çš„å¤§å°ä¸åˆç†ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦å¤„ç†æ¯”è¾ƒå¯è§‚çš„æ•°æ®é‡ï¼Œä½†æ˜¯æ²¡æœ‰æ˜¾å¼æŒ‡å®š JVM å †å¤§å°æˆ–è€…æŒ‡å®šæ•°å€¼åå°ï¼›æˆ–è€…å‡ºç° JVM å¤„ç†å¼•ç”¨ä¸åŠæ—¶ï¼Œå¯¼è‡´å †ç§¯èµ·æ¥ï¼Œå†…å­˜æ— æ³•é‡Šæ”¾ç­‰ã€‚
*   è€Œå¯¹äº Java è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œè¿™é‡Œè¦ç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚å¦‚æœæˆ‘ä»¬å†™ä¸€æ®µç¨‹åºä¸æ–­çš„è¿›è¡Œé€’å½’è°ƒç”¨ï¼Œè€Œä¸”æ²¡æœ‰é€€å‡ºæ¡ä»¶ï¼Œå°±ä¼šå¯¼è‡´ä¸æ–­åœ°è¿›è¡Œå‹æ ˆã€‚ç±»ä¼¼è¿™ç§æƒ…å†µï¼ŒJVM å®é™…ä¼šæŠ›å‡º StackOverFlowErrorï¼›å½“ç„¶ï¼Œå¦‚æœ JVM è¯•å›¾å»æ‰©å±•æ ˆç©ºé—´çš„çš„æ—¶å€™å¤±è´¥ï¼Œåˆ™ä¼šæŠ›å‡º OutOfMemoryErrorã€‚
*   å¯¹äºè€ç‰ˆæœ¬çš„ Oracle JDKï¼Œå› ä¸ºæ°¸ä¹…ä»£çš„å¤§å°æ˜¯æœ‰é™çš„ï¼Œå¹¶ä¸” JVM å¯¹æ°¸ä¹…ä»£åƒåœ¾å›æ”¶ï¼ˆå¦‚ï¼Œå¸¸é‡æ± å›æ”¶ã€å¸è½½ä¸å†éœ€è¦çš„ç±»å‹ï¼‰éå¸¸ä¸ç§¯æï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä¸æ–­æ·»åŠ æ–°ç±»å‹çš„æ—¶å€™ï¼Œæ°¸ä¹…ä»£å‡ºç° OutOfMemoryError ä¹Ÿéå¸¸å¤šè§ï¼Œå°¤å…¶æ˜¯åœ¨è¿è¡Œæ—¶å­˜åœ¨å¤§é‡åŠ¨æ€ç±»å‹ç”Ÿæˆçš„åœºåˆï¼›ç±»ä¼¼ Intern å­—ç¬¦ä¸²ç¼“å­˜å ç”¨å¤ªå¤šç©ºé—´ï¼Œä¹Ÿä¼šå¯¼è‡´ OOM é—®é¢˜ã€‚å¯¹åº”çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä¼šæ ‡è®°å‡ºæ¥å’Œæ°¸ä¹…ä»£ç›¸å…³ï¼šâ€œjava.lang.OutOfMemoryError: PermGen spaceâ€ã€‚
*   éšç€å…ƒæ•°æ®åŒºçš„å¼•å…¥ï¼Œæ–¹æ³•åŒºå†…å­˜å·²ç»ä¸å†é‚£ä¹ˆçª˜è¿«ï¼Œæ‰€ä»¥ç›¸åº”çš„ OOM æœ‰æ‰€æ”¹è§‚ï¼Œå‡ºç° OOMï¼Œå¼‚å¸¸ä¿¡æ¯åˆ™å˜æˆäº†ï¼šâ€œjava.lang.OutOfMemoryError: Metaspaceâ€ã€‚
*   ç›´æ¥å†…å­˜ä¸è¶³ï¼Œä¹Ÿä¼šå¯¼è‡´ OOMï¼Œè¿™ä¸ªå·²ç»åœ¨åšæ–‡ [ã€JAVAã€‘NIO å¦‚ä½•å®ç°å¤šè·¯å¤ç”¨ï¼Ÿ](https://juejin.cn/post/7154529075845939230 "https://juejin.cn/post/7154529075845939230") ä¸­ä»‹ç»è¿‡ã€‚

åè®°
==

ä»¥ä¸Šå°±æ˜¯Â **ã€JAVAã€‘JVM å†…å­˜åŒºåŸŸçš„åˆ’åˆ†**Â çš„æ‰€æœ‰å†…å®¹äº†;

ä»‹ç»äº†ä¸»è¦çš„å†…å­˜åŒºåŸŸï¼Œä»¥åŠåœ¨ä¸åŒç‰ˆæœ¬ Hotspot JVM å†…éƒ¨çš„å˜åŒ–ï¼Œå¹¶ä¸”åˆ†æäº†å„åŒºåŸŸæ˜¯å¦å¯èƒ½äº§ç”Ÿ OutOfMemoryErrorï¼Œä»¥åŠ OOME å‘ç”Ÿçš„å…¸å‹æƒ…å†µã€‚

> ğŸ“ ä¸Šç¯‡ç²¾è®²ï¼š[ã€JAVAã€‘ä¸ä¼šæœ‰äººä¸çŸ¥é“ Java ç±»èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆå§ï¼Ÿ](https://juejin.cn/post/7158735186920734756 "https://juejin.cn/post/7158735186920734756")
> 
> ğŸ’– æˆ‘æ˜¯Â **ğ“¼ğ“²ğ“­ğ“²ğ“¸ğ“½**ï¼ŒæœŸå¾…ä½ çš„å…³æ³¨ï¼›
> 
> ğŸ‘ åˆ›ä½œä¸æ˜“ï¼Œè¯·å¤šå¤šæ”¯æŒï¼›
> 
> ğŸ”¥ ç³»åˆ—ä¸“æ ï¼šÂ [é¢è¯•ç²¾è®²](https://juejin.cn/column/7151779675549728782 "https://juejin.cn/column/7151779675549728782") [JAVA](https://juejin.cn/column/7143109530753171486 "https://juejin.cn/column/7143109530753171486")